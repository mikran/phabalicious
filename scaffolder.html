<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scaffolding arbitrary files | Phabalicious</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="A deployment system and general purpose helper">
    <link rel="preload" href="/phabalicious/assets/css/0.styles.8724a115.css" as="style"><link rel="preload" href="/phabalicious/assets/js/app.a0dcc876.js" as="script"><link rel="preload" href="/phabalicious/assets/js/3.a8946bf4.js" as="script"><link rel="preload" href="/phabalicious/assets/js/22.ef47fd32.js" as="script"><link rel="prefetch" href="/phabalicious/assets/js/10.58970bcb.js"><link rel="prefetch" href="/phabalicious/assets/js/11.74dd907f.js"><link rel="prefetch" href="/phabalicious/assets/js/12.bfc60ded.js"><link rel="prefetch" href="/phabalicious/assets/js/13.1746a4c7.js"><link rel="prefetch" href="/phabalicious/assets/js/14.631d6dc3.js"><link rel="prefetch" href="/phabalicious/assets/js/15.e9f86779.js"><link rel="prefetch" href="/phabalicious/assets/js/16.79bbd755.js"><link rel="prefetch" href="/phabalicious/assets/js/17.92c6f019.js"><link rel="prefetch" href="/phabalicious/assets/js/18.b0c07537.js"><link rel="prefetch" href="/phabalicious/assets/js/19.d67617f0.js"><link rel="prefetch" href="/phabalicious/assets/js/20.9cb2482f.js"><link rel="prefetch" href="/phabalicious/assets/js/21.76b13cd0.js"><link rel="prefetch" href="/phabalicious/assets/js/23.75afdda6.js"><link rel="prefetch" href="/phabalicious/assets/js/24.8f3f0c41.js"><link rel="prefetch" href="/phabalicious/assets/js/4.45282513.js"><link rel="prefetch" href="/phabalicious/assets/js/5.69ba307c.js"><link rel="prefetch" href="/phabalicious/assets/js/6.8bee04d6.js"><link rel="prefetch" href="/phabalicious/assets/js/7.90dd9d27.js"><link rel="prefetch" href="/phabalicious/assets/js/8.6449e185.js"><link rel="prefetch" href="/phabalicious/assets/js/9.8b267180.js"><link rel="prefetch" href="/phabalicious/assets/js/vendors~docsearch.72c12505.js">
    <link rel="stylesheet" href="/phabalicious/assets/css/0.styles.8724a115.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/phabalicious/" class="home-link router-link-active"><!----> <span class="site-name">Phabalicious</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"> <a href="https://github.com/factorial-io/phabalicious" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/factorial-io/phabalicious" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/phabalicious/guide.html" class="sidebar-link">How does phabalicious work in two sentences</a></li><li><a href="/phabalicious/installation.html" class="sidebar-link">Installation of needed dependencies</a></li><li><a href="/phabalicious/usage.html" class="sidebar-link">Running phabalicious</a></li><li><a href="/phabalicious/available-tasks.html" class="sidebar-link">Available tasks</a></li><li><a href="/phabalicious/configuration.html" class="sidebar-link">Structure of the configuration file</a></li><li><a href="/phabalicious/inheritance.html" class="sidebar-link">Inheritance</a></li><li><a href="/phabalicious/docker-integration.html" class="sidebar-link">Docker integration</a></li><li><a href="/phabalicious/workspace.html" class="sidebar-link">Setup a local dev environment (multibasebox)</a></li><li><a href="/phabalicious/scripts.html" class="sidebar-link">Scripts</a></li><li><a href="/phabalicious/scaffolder.html" aria-current="page" class="active sidebar-link">Scaffolding arbitrary files</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#running-the-command" class="sidebar-link">Running the command</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#the-scaffold-file" class="sidebar-link">the scaffold-file</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#list-of-supported-internal-commands" class="sidebar-link">List of supported internal commands:</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#list-of-commands-which-needs-one-or-more-plugin-implementations" class="sidebar-link">List of commands which needs one or more plugin implementations</a></li></ul></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#copy-assets" class="sidebar-link">copy_assets</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#log-message-severity-message" class="sidebar-link">log_message(severity, message)</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#alter-json-file-file-path-data-ref" class="sidebar-link">alter_json_file(file_path, data_ref)</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#assert-file-file-path-error-message" class="sidebar-link">assert_file(file_path, error_message)</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#confirm-message" class="sidebar-link">confirm(message)</a></li><li class="sidebar-sub-header"><a href="/phabalicious/scaffolder.html#transform" class="sidebar-link">transform</a></li></ul></li><li><a href="/phabalicious/app-scaffold.html" class="sidebar-link">Scaffolding a new app</a></li><li><a href="/phabalicious/app-create-destroy.html" class="sidebar-link">Creating/ destroying an app from existing configuration</a></li><li><a href="/phabalicious/deploying-artifacts.html" class="sidebar-link">Deploying artifacts</a></li><li><a href="/phabalicious/kubernetes.html" class="sidebar-link">Kubernetes integration</a></li><li><a href="/phabalicious/local-overrides.html" class="sidebar-link">Local overrides</a></li><li><a href="/phabalicious/passwords.html" class="sidebar-link">Passwords</a></li><li><a href="/phabalicious/contribute.html" class="sidebar-link">Contributing to Phabalicious</a></li><li><a href="/phabalicious/Changelog.html" class="sidebar-link">Changelog</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="scaffolding-arbitrary-files"><a href="#scaffolding-arbitrary-files" class="header-anchor">#</a> Scaffolding arbitrary files</h1> <p>Phabalicious supports not only scaffolding new applications, but arbitrary files. The command allows to be extended by socalled plugins which implements <code>Phabalicious\Utilities\PluginInterface</code>. The following plugin types are currently supported:</p> <ul><li><code>transformers</code>, they take a yaml file as input, transform them to something different which will be written to the filesystem. transformer-plugins need to implement <code>Phabalicious\Scaffolder\Transformers\DataTransformerInterface</code>.</li></ul> <h2 id="running-the-command"><a href="#running-the-command" class="header-anchor">#</a> Running the command</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>phab scaffold path/to/scaffold-file.yaml
</code></pre></div><h2 id="the-scaffold-file"><a href="#the-scaffold-file" class="header-anchor">#</a> the scaffold-file</h2> <p>The scaffold-file has the same structure as used for scaffolding applications. Here's an example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">requires</span><span class="token punctuation">:</span> <span class="token number">3.4</span>

<span class="token key atrule">plugins</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> vendor/factorial<span class="token punctuation">-</span>io/phab<span class="token punctuation">-</span>entity<span class="token punctuation">-</span>scaffolder/src/transformers

<span class="token key atrule">image_styles</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> image_style

<span class="token key atrule">block_content</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> block_content

<span class="token key atrule">scaffold</span><span class="token punctuation">:</span>
   <span class="token punctuation">-</span> transform(block_content<span class="token punctuation">,</span> block_content<span class="token punctuation">,</span> config/sync)
   <span class="token punctuation">-</span> transform(imagestyles<span class="token punctuation">,</span> image_styles<span class="token punctuation">,</span> config/sync)
</code></pre></div><ul><li><code>requires</code> set the minimal phabalicious version this file works with.</li> <li>the <code>plugins</code>-section reference paths to phabalicious-plugins. Every php file in that folder will be tried to be included and checked if they implement the required interfaces.</li> <li><code>scaffold</code> contains a list of script lines where replacement patterns a]get replaced and run via bash, if not an internal command is used.</li> <li>It may also contain <code>assets</code> and/or <code>questions</code> as described in <a href="/phabalicious/app-scaffold.html">here</a>, but they are not required.</li></ul> <h3 id="list-of-supported-internal-commands"><a href="#list-of-supported-internal-commands" class="header-anchor">#</a> List of supported internal commands:</h3> <ul><li><code>log_message</code> to print a message with a severity</li> <li><code>copy_assets</code> to copy assets and apply replacement patterns</li> <li><code>alter_json_file</code> which will alter an existing json file and change some data</li> <li><code>assert_file</code> throws an exception if the file does not exist</li></ul> <h3 id="list-of-commands-which-needs-one-or-more-plugin-implementations"><a href="#list-of-commands-which-needs-one-or-more-plugin-implementations" class="header-anchor">#</a> List of commands which needs one or more plugin implementations</h3> <ul><li><code>transform</code> to transform a bunch of yml files to sth different. This command needs an implementation via plugin</li></ul> <h2 id="copy-assets"><a href="#copy-assets" class="header-anchor">#</a> <code>copy_assets</code></h2> <p><code>copy_assets</code> can be used in the scaffold-section to copy assets  into a specific location. The syntax is</p> <div class="language- extra-class"><pre class="language-text"><code>copy_assets(&lt;targetFolder&gt;, &lt;assetsKey=assets&gt;, &lt;fileExtensionForTwigParsing&gt;)
</code></pre></div><p>Phabalicious will load the asset-file, apply the replacement-patterns to the file-name (<a href="/phabalicious/app-scaffold.html">see</a> the <code>deploymentAssetsfor</code> an example) and parse the content via twig. The result will be stored inside the <code>&lt;targetFolder&gt;</code>. If <code>&lt;fileExtensionForTwigParsing&gt;</code> is set, then only files with that extension will be handled by twig.</p> <h2 id="log-message-severity-message"><a href="#log-message-severity-message" class="header-anchor">#</a> <code>log_message(severity, message)</code></h2> <p><code>log_message</code> will log a string to the output of phabalicious. It supports several notification levels, e.g.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">scaffold</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> log_message(info<span class="token punctuation">|</span>warning<span class="token punctuation">|</span>error<span class="token punctuation">|</span>success<span class="token punctuation">,</span> the message to display)
</code></pre></div><h2 id="alter-json-file-file-path-data-ref"><a href="#alter-json-file-file-path-data-ref" class="header-anchor">#</a> <code>alter_json_file(file_path, data_ref)</code></h2> <p>This internal command can alter a json-file. It will merge the data from a yaml section into the json file. Here's an example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>
<span class="token key atrule">dataToInject</span><span class="token punctuation">:</span>
  <span class="token key atrule">one</span><span class="token punctuation">:</span> foo
  <span class="token key atrule">two</span><span class="token punctuation">:</span> bar
  <span class="token key atrule">dict</span><span class="token punctuation">:</span>
    <span class="token key atrule">one</span><span class="token punctuation">:</span> boo
    <span class="token key atrule">two</span><span class="token punctuation">:</span> far

<span class="token key atrule">scaffold</span><span class="token punctuation">:</span>
  alter_json_file(package.json<span class="token punctuation">,</span> dataToInject)
</code></pre></div><h2 id="assert-file-file-path-error-message"><a href="#assert-file-file-path-error-message" class="header-anchor">#</a> <code>assert_file(file_path, error_message)</code></h2> <p>This internal command will throw an exception if the specified file does not exist. Useful to check if the user is in the right directory.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">scaffold</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> assert_file(&lt;file_path<span class="token punctuation">&gt;</span><span class="token punctuation">,</span> &lt;error_message<span class="token punctuation">&gt;</span>)
</code></pre></div><h2 id="confirm-message"><a href="#confirm-message" class="header-anchor">#</a> <code>confirm(message)</code></h2> <p>This internal command will ask the user for confirmation before continuing showing <code>message</code>.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">scaffold</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> confirm(&lt;message<span class="token punctuation">&gt;</span>)
</code></pre></div><h2 id="transform"><a href="#transform" class="header-anchor">#</a> <code>transform</code></h2> <p>This internal command will transform a list of yml files to sth different with the help of plugins. THe plugins need to be declared in the <code>plugins</code>-section.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">scaffold</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> transform(&lt;nameOfPlugin<span class="token punctuation">&gt;</span><span class="token punctuation">,</span> &lt;yamlKeyToGetListOfFilesFrom<span class="token punctuation">&gt;</span><span class="token punctuation">,</span> &lt;targetPath<span class="token punctuation">&gt;</span>)
</code></pre></div><ul><li><code>&lt;nameOfPlugin&gt;</code> is the plugin-name to use for the trnasforming. Depends on the plugin implementation</li> <li><code>&lt;yamlKeyToGetListOfFilesFrom&gt;</code> Similar to <code>copy_assets</code>, its a reference in the yaml-file which contains a list of files/ directories where phabalicious will try to load yaml files from.</li> <li><code>&lt;targetPath&gt;</code> the target directory where the resulting files should be saved to.</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/factorial-io/phabalicious/edit/master/docs/scaffolder.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/phabalicious/scripts.html" class="prev">
        Scripts
      </a></span> <span class="next"><a href="/phabalicious/app-scaffold.html">
        Scaffolding a new app
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/phabalicious/assets/js/app.a0dcc876.js" defer></script><script src="/phabalicious/assets/js/3.a8946bf4.js" defer></script><script src="/phabalicious/assets/js/22.ef47fd32.js" defer></script>
  </body>
</html>
